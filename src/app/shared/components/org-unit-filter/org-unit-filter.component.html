<div class="panel panel-default" style="border-style: none; margin-bottom: 0px; margin-top: 0px; border-bottom: solid 1px #eee;">
  <div class="panel-heading" style="padding-bottom: 10px;padding-top: 10px;padding-left: 15px">
    <div class="" (click)="displayOrgTree()">
          <span *ngIf="!orgunit_tree_config.loading">
              {{  getProperPreOrgunitName() }}
          </span>
      <span *ngIf="orgunit_model.selected_orgunits.length > 10 && orgunit_model.selected_user_orgunit.length == 0">
            <span class="selected-item">
              {{ orgunit_model.selected_orgunits[0].name }}
              <a (click)="deActivateNode(orgunit_model.selected_orgunits[0].id,orgtree,$event)" class="removeorgunit" >x</a>
            </span>
            <span class="selected-item">
              {{ orgunit_model.selected_orgunits[1].name }}
              <a (click)="deActivateNode(orgunit_model.selected_orgunits[1].id,orgtree,$event)" class="removeorgunit">x</a>
            </span>
            <span class="selected-item">
              &nbsp; and {{ orgunit_model.selected_orgunits.length - 2 }} more
            </span>
          </span>
      <span *ngIf="orgunit_model.selected_orgunits.length <= 10 && orgunit_model.selected_user_orgunit.length == 0">
             <span *ngFor="let item of orgunit_model.selected_orgunits" class="selected-item ng-binding ng-scope">
              {{ item.name }}
               <a (click)="deActivateNode(item.id,orgtree,$event)" class="removeorgunit">x</a>
            </span>
          </span>
      <span class="no-selection"*ngIf="orgunit_model.selected_orgunits.length == 0 && !orgunit_tree_config.loading && orgunit_model.selection_mode != 'Usr_orgUnit'">{{ orgunit_tree_config.placeholder }}</span>
      <span  *ngIf="orgunit_model.selected_orgunits.length > 0" class="pull-right">
        <span class="selected-item" style="cursor: pointer" (click)="clearAll()" style="opacity: 0.7">X clear all</span>
      </span>
      <span *ngIf="orgunit_tree_config.loading">{{ orgunit_tree_config.loading_message }}</span>
    </div>
  </div>
</div>
<div class="panel-body" style="padding: 3px;" [ngClass]="{'hiddenTree':showOrgTree}">
  <div class="" [ngClass]="{'hiddenTree':showOrgTree}" id="tree_view">
    <div class="col-sm-3" style="padding-left: 0px; margin-bottom: 5px">
      <div class="btn-group" *ngIf="orgunit_tree_config.show_levels">
        <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" title="Switch selection between: by Level, Group or Current selected">
          <img *ngIf="orgunit_model.selection_mode == 'orgUnit'" src="assets/img/icons8-Tree.png" class="group-image">
          <img *ngIf="orgunit_model.selection_mode == 'Level'" src="assets/img/icons8-Genealogy.png" class="group-image">
          <img *ngIf="orgunit_model.selection_mode == 'Group'" src="assets/img/icons8-Group.png" class="group-image">
          <span class="caret"></span>
        </button>
        <ul class="dropdown-menu">
          <li>
            <a (click)="setType('orgUnit')">
              <span *ngIf="orgunit_model.selection_mode == 'orgUnit'" class="glyphicon glyphicon-ok"></span>
              <img src="assets/img/icons8-Tree.png" alt="tree" class="group-image">
              Select Administrative Unit
            </a>
          </li>
          <li>
            <a (click)="setType('Level')">
              <span *ngIf="orgunit_model.selection_mode == 'Level'" class="glyphicon glyphicon-ok"></span>
              <img src="assets/img/icons8-Genealogy.png" alt="category" class="group-image">
              Select Level
            </a>
          </li>
          <li>
            <a (click)="setType('Group')">
              <span *ngIf="orgunit_model.selection_mode == 'Group'" class="glyphicon glyphicon-ok"></span>
              <img src="assets/img/icons8-Group.png" alt="group" class="group-image">
              Select Group
            </a>
          </li>
        </ul>
      </div>
    </div>
    <div  *ngIf="orgunit_tree_config.show_levels">
      <!--org_unit_groups-->
      <div class="col-sm-9" style="padding-right: 0px; margin-bottom: 5px" *ngIf="orgunit_model.selection_mode == 'Group'">
          <tulonge-multiselect [placeholder]="'Select Admin.units group'" [selected_items]="orgunit_model.selected_groups" [items]="orgunit_model.orgunit_groups" (selected)="setSelectedGroups($event)"></tulonge-multiselect>

        </div>
        <!--user_org_unit-->
        <div class="col-sm-9" style="padding-right: 0px; margin-bottom: 5px" [ngClass]="{'hiddenTree': orgunit_model.selection_mode != 'orgUnit'}">
          <tulonge-multiselect #period_selector [placeholder]="'Select Administrative Unit'" [items]="user_orgunits_types" (selected)="setSelectedUserOrg($event)"></tulonge-multiselect>

        </div>
        <!--org_unit_levels-->
        <div class="col-sm-9" style="padding-right: 0px; margin-bottom: 5px" *ngIf="orgunit_model.selection_mode == 'Level'">
          <tulonge-multiselect [prefix]="'Level: '" [prefix_multiple]="'Levels: '" [placeholder]="'Select Admin.units levels'" [selected_items]="orgunit_model.selected_levels" [items]="orgunit_model.orgunit_levels" (selected)="setSelectedLevels($event)"></tulonge-multiselect>

        </div>
    </div>
    <tulonge-placeholder [numberOfLines]="40" *ngIf="orgunit_tree_config.loading"></tulonge-placeholder>
    <div class="tree-area" [ngClass]="{'someclass': orgunit_model.selected_user_orgunit.length != 0}">
      <tree-root
        #orgtree
        [nodes]="organisationunits | async"
        [focused]="true"
        [options]="customTemplateStringOrgunitOptions | async"
        (activate)="activateOrg($event)"
        (deactivate)="deactivateOrg($event)"
      >
        <ng-template #treeNodeTemplate let-node>
          <span (click)="updateModelOnSelect(node.data)" style="font-size: 12px">{{ node.data.name }}</span>
        </ng-template>
      </tree-root>
    </div>

  </div>
</div>

